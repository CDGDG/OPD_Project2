{% extends 'base.html' %}
{% block title %}비밀번호 찾기{% endblock  %}
{% block content %}
{% load bootstrap4 %}
<h2>비밀번호 찾기</h2>
<hr>
<form class="px-4 py-3" method="POST" action="{% url 'Admin:forgot_password' %}" name="resetPassword">
    <p>현재 사용중인 아이디를 입력해 주세요</p>
    {% csrf_token %}
    <div class="form-group row">
      <div class="col-6">
        <input type="radio" class="btn-check" name="who" id="developer" value="developer" autocomplete="off" checked>
        <label class="btn login-select col-12" for="developer">개발자</label>
      </div>
    <div class="col-6">
      <input type="radio" class="btn-check" name="who" id="company" value="company" autocomplete="off">
      <label class="btn login-select col-12" for="company">기업</label>
    </div>
    </div>
    <div class="form-group mt-2">
      <label for="userid">아이디</label>
      <input type="text" class="form-control" id="userid" placeholder="아이디" name="userid">
      <span id="check_userid"></span>
    </div>
    <a type="button" id='checkuserid' class="btn btn-outline-dark">입력</a>
    <a type="button" class="btn btn-outline-dark" onclick="history.back()">취소</a>
  </form>
{% endblock content %}
{% block script %}
<script>
        $('#checkuserid').click(function(){
            var frm = document.forms['forgotPassword']
            var select = $("input[name='selectWho']:checked").val()
            var userid = $('#userid').val()
            $.ajax({
                url:"{% url 'Admin:forgot_password' %}",
                type:"POST",
                data : {'csrfmiddlewaretoken': '{{csrf_token}}','userid':userid,'select':select},
                datatype:'json',
                success:function(response){
                    if(response.blank){
                        $('#check_userid').html('<p>아이디를 입력해주세요</p>')
                        return;
                    }else{
                        if(response.data == 'wrong id'){
                            $('#check_userid').html('<p style="color:red">아이디가 존재하지 않습니다.</p>')
                          }else if(response.data == "success"){
                              location.href = "{% url 'Admin:reset_password' %}"
                          }
                    
                    }

                }
            
            })
        })
</script>
{% endblock  %}